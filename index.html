<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DRG Weekly Deep Dives</title>
</head>
<body>
    <h1>Weekly Deep Dive</h1>
    <div id="deep-dive-info">
        <p>Loading Deep Dive information...</p>
    </div>

    <script>
        // Our JavaScript code will go her
fetch('https://drgapi.com/v1/deepdives')
  .then(response => {
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    return response.json();
  })
  .then(data => {
    console.log(data); // Keep this for now to see the structure

    const deepDiveInfoDiv = document.getElementById('deep-dive-info');
    deepDiveInfoDiv.innerHTML = ''; // Clear "Loading..."

    // **Step 1: Find the current Deep Dive object**
    // You'll need to determine how the API indicates the current one.
    // It might be the first in the array, or there might be a property like 'isCurrent: true'.

    let currentDive;

    // **Example 1: If the first item is always the current one**
    if (data && Array.isArray(data) && data.length > 0) {
      currentDive = data[0];
    }

    // **Example 2: If there's an 'isCurrent' property (adjust the property name if needed)**
    // if (data && Array.isArray(data)) {
    //   currentDive = data.find(dive => dive.isCurrent === true);
    // }

    if (currentDive) {
      const nameHeading = document.createElement('h2');
      nameHeading.textContent = currentDive.name || 'Deep Dive'; // Assuming there's a 'name' property

      deepDiveInfoDiv.appendChild(nameHeading);

      // **Step 2: Access the stages (assuming it's an array)**
      if (currentDive.stages && Array.isArray(currentDive.stages)) {
        const stagesHeading = document.createElement('h3');
        stagesHeading.textContent = 'Stages:';
        deepDiveInfoDiv.appendChild(stagesHeading);

        currentDive.stages.forEach((stage, index) => {
          const stageInfo = document.createElement('div');
          stageInfo.innerHTML = `<h4>Stage ${index + 1}</h4>`;

          if (stage.mission && stage.mission.name) {
            stageInfo.innerHTML += `<p>Mission: ${stage.mission.name}</p>`;
          }
          if (stage.planet && stage.planet.name) {
            stageInfo.innerHTML += `<p>Planet: ${stage.planet.name}</p>`;
          }

          // **Step 3: Access the modifiers (assuming it's an array)**
          if (stage.modifiers && Array.isArray(stage.modifiers)) {
            const modifiersList = document.createElement('ul');
            modifiersList.innerHTML += '<li>Modifiers:</li>';
            stage.modifiers.forEach(modifier => {
              if (modifier.name) {
                modifiersList.innerHTML += `<li>${modifier.name}</li>`;
              }
            });
            stageInfo.appendChild(modifiersList);
          }

          deepDiveInfoDiv.appendChild(stageInfo);
        });
      } else {
        deepDiveInfoDiv.textContent = 'No stage information found.';
      }
    } else {
      deepDiveInfoDiv.textContent = 'No current Deep Dive information found.';
    }
  })
  .catch(error => {
    console.error('Error fetching Deep Dive data:', error);
    const deepDiveInfoDiv = document.getElementById('deep-dive-info');
    deepDiveInfoDiv.textContent = 'Failed to load Deep Dive information.';
  });
    </script>
</body>
</html>
